<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.2 -->
    <script>
        window.materialVersion = "1.5.2"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">


    <link rel="dns-prefetch" href="https://cdn1.lncld.net">













    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            利用 Blockly 实现诗歌匹配场景 | 
        
        海树
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/fish.png">
    <link rel="icon" href="/img/favicon.png">

    <meta name="format-detection" content="telephone=no">
    <meta name="description" itemprop="description" content>
    <meta name="keywords" content=",Blockly4Android">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?MKetZV3cUTfDxvMffaOezg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="海树">
    <meta name="msapplication-starturl" content="http://yoursite.com/2018/03/13/use-blockly-in-poetry-match/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="海树">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://yoursite.com/2018/03/13/use-blockly-in-poetry-match/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="利用 Blockly 实现诗歌匹配场景 | 海树">
    <meta property="og:image" content="/img/favicon.png">
    <meta property="og:description" content>
    <meta property="og:article:tag" content="Blockly4Android"> 

    
        <meta property="article:published_time" content="Tue Mar 13 2018 17:37:00 GMT+0800">
        <meta property="article:modified_time" content="Tue Nov 06 2018 20:09:54 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://yoursite.com/2018/03/13/use-blockly-in-poetry-match/index.html">
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "http://yoursite.com/2018/03/13/use-blockly-in-poetry-match/index.html",
    "headline": "利用 Blockly 实现诗歌匹配场景",
    "datePublished": "Tue Mar 13 2018 17:37:00 GMT+0800",
    "dateModified": "Tue Nov 06 2018 20:09:54 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "Owen Lee",
        "image": {
            "@type": "ImageObject",
            "url": "/img/icon.jpg"
        },
        "description": "我心有猛虎  细嗅蔷薇香"
    },
    "publisher": {
        "@type": "Organization",
        "name": "海树",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/favicon.png"
        }
    },
    "keywords": ",Blockly4Android",
    "description": "",
}
</script>


    

    <!-- Analytics -->
    
    
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#前言"><span class="post-toc-number">1.</span> <span class="post-toc-text">前言</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#实现流程"><span class="post-toc-number">2.</span> <span class="post-toc-text">实现流程</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#1-定义所需的块"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">1. 定义所需的块</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#2-创建-Toolbox（工具栏）文件"><span class="post-toc-number">2.2.</span> <span class="post-toc-text">2. 创建 Toolbox（工具栏）文件</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#3-创建生成器函数"><span class="post-toc-number">2.3.</span> <span class="post-toc-text">3. 创建生成器函数</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#4-建立数据实体类和数据库"><span class="post-toc-number">2.4.</span> <span class="post-toc-text">4. 建立数据实体类和数据库</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#5-初始化Activity"><span class="post-toc-number">2.5.</span> <span class="post-toc-text">5.  初始化Activity</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#6-从数据库中提取数据封装成工作区中的块"><span class="post-toc-number">2.6.</span> <span class="post-toc-text">6. 从数据库中提取数据封装成工作区中的块</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#7-实现多重关卡"><span class="post-toc-number">2.7.</span> <span class="post-toc-text">7. 实现多重关卡</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#8-编写匹配判断逻辑"><span class="post-toc-number">2.8.</span> <span class="post-toc-text">8. 编写匹配判断逻辑</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#结语"><span class="post-toc-number">2.9.</span> <span class="post-toc-text">结语</span></a></li></ol></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        <!-- Custom Thumbnail -->
        <div class="post_thumbnail-custom mdl-card__media mdl-color-text--grey-50" style="background-image:url(http://image.wufazhuce.com/FqIXhl149Pj1AftgRFBOxiC2MXwz)">
    
            <p class="article-headline-p">
                利用 Blockly 实现诗歌匹配场景
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/icon.jpg" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Owen Lee</strong>
        <span>3月 13, 2018</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/Blockly4Android/">Blockly4Android</a>
    </ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    
    <!-- Leancloud Views -->
        <a class="post_share-link" href="#">
            <li class="mdl-menu__item">
                <span id="/2018/03/13/use-blockly-in-poetry-match/" class="leancloud-views_num" data-flag-title="利用 Blockly 实现诗歌匹配场景">
     &nbsp;浏览量
</span>

            </li>
        </a>
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=利用 Blockly 实现诗歌匹配场景&url=http://yoursite.com/2018/03/13/use-blockly-in-poetry-match/index.html&pic=http://yoursite.com/img/fish.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=利用 Blockly 实现诗歌匹配场景&url=http://yoursite.com/2018/03/13/use-blockly-in-poetry-match/index.html&via=Owen Lee" target="_blank">
            <li class="mdl-menu__item">
                分享到 Twitter
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=http://yoursite.com/2018/03/13/use-blockly-in-poetry-match/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Facebook
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=http://yoursite.com/2018/03/13/use-blockly-in-poetry-match/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 Google+
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=海树&title=利用 Blockly 实现诗歌匹配场景&summary=&pics=http://yoursite.com/img/fish.png&url=http://yoursite.com/2018/03/13/use-blockly-in-poetry-match/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>在 KidProgramming 这个项目中，第一模块适用于儿童启蒙，我们设计一些知识主题，如动物百科、古诗阅读等，让小朋友了解一些知识。在学习过一些知识后，我们给他们设计了挑战环节，这个环节中就将 Blockly 运用进来，从学过的知识中抽取一些，做成一些 Blockly 的块，让儿童拖拽这些块进行拼接，比如将一首诗的正确诗句以正确的顺序拼到相应的诗名里。</p>
<p>刚刚进入这个 Activity 是这样的：</p>
<p><img src="https://ws1.sinaimg.cn/large/006g8PWvly1fwylmk8ffjj31hc0u0q9w.jpg" alt></p>
<p>拼好后，点击运行，是这样的：<br><img src="https://ws1.sinaimg.cn/large/006g8PWvly1fwylmresa0j31hc0u0gst.jpg" alt></p>
<h3 id="实现流程"><a href="#实现流程" class="headerlink" title="实现流程"></a>实现流程</h3><h4 id="1-定义所需的块"><a href="#1-定义所需的块" class="headerlink" title="1. 定义所需的块"></a>1. 定义所需的块</h4><p>在 Blockly 中有许多已经定义好的内置块，比如：</p>
<p><img src="https://ws1.sinaimg.cn/large/006g8PWvly1fwylnoc7p3j30fp04yaa2.jpg" alt></p>
<p>而我们要实现自己设计的场景，就需要我们自己去定义需要的块。从演示图中可以看出，这里一共有三种不同的块。有左凸的诗名块（下图第二个），有上下连接点诗句块（下图第三个）和放置诗名和诗句的框架块（下图第一个）</p>
<p><img src="https://ws1.sinaimg.cn/large/006g8PWvly1fwyln728j3j31hc0u00wx.jpg" alt></p>
<p>定义一个块有两种形式，一种是 Json，一种是 JS 代码，因为 Json 具有跨平台的特点，所以是首选的块定义形式，也是 Android 中唯一的定义方式。</p>
<p>下面是第一个块定义的 Json文本：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;type&quot;: &quot;poetry&quot;,</span><br><span class="line">    &quot;message0&quot;: &quot;诗名： %1 内容： %2&quot;,</span><br><span class="line">    &quot;args0&quot;: [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;type&quot;: &quot;input_value&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;TITLE&quot;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;type&quot;: &quot;input_statement&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;CONTENT&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    &quot;colour&quot;: 120,</span><br><span class="line">    &quot;tooltip&quot;: &quot;&quot;,</span><br><span class="line">    &quot;helpUrl&quot;: &quot;&quot;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>关于 Json代码中各个属性的含义，请参考官方文档中的块定义部分。</p>
<p>进行块的定义时，可以直接写 Json 代码（有点难），也可以借助一个网站（需要翻墙）——「<a href="https://blockly-demo.appspot.com/static/demos/blockfactory/index.html" target="_blank" rel="noopener">Blockly开发者工具</a>」，在这里可以用可视化的方式来创建一个块，可以直接看到块的预览形状。我们最后只需要将自动形成的 Json 代码复制下来，应用到项目中去即可。</p>
<p>具体的操作方法见官方文档「Blockly 开发者工具」篇， 去网站上练习几次即可掌握。</p>
<p>将所有用到的块的 Json 代码写在一个 .json 类型的文件中，放在项目的 assets 目录下。</p>
<h4 id="2-创建-Toolbox（工具栏）文件"><a href="#2-创建-Toolbox（工具栏）文件" class="headerlink" title="2. 创建 Toolbox（工具栏）文件"></a>2. 创建 Toolbox（工具栏）文件</h4><p>在这个场景中我们的块都是直接生成在工作区中，Toolbox 中并没有放置块。所以我们直接创建一个名为 toolbox.xml 的文件，放在 assets 目录下，内容为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;toolbox&gt;&lt;/toolbox&gt;</span><br></pre></td></tr></table></figure>

<p>就可以满足需要了。在其他的场景中如果需要用到工具栏，则需要在 toolbox.xml 文件中填入相应块的引用，便于用户可以直接从工具栏中拖出想要的块。具体如何写 Toolbox 文件，请看官方文档 Toolbox 相关内容。</p>
<h4 id="3-创建生成器函数"><a href="#3-创建生成器函数" class="headerlink" title="3. 创建生成器函数"></a>3. 创建生成器函数</h4><p>每个块都对应一个用 JS 编写的生成器函数，在这个函数中将这个块转化为一段字符串类型的代码。这个代码我们将在 Activity 的回调中用到，判断是否匹配正确。如果我们使用 「Blockly开发者工具」，我们可以在网页上直接复制一个块的生成器函数模版，然后再自定义。一个 type 为 poetry 的块的生成器函数如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Blockly.JavaScript[&apos;poetry&apos;] = function(block) &#123;</span><br><span class="line">    var title = Blockly.JavaScript.statementToCode(block, &apos;TITLE&apos;).substring(2);</span><br><span class="line">    var content = Blockly.JavaScript.statementToCode(block, &apos;CONTENT&apos;).substring(2);</span><br><span class="line">    </span><br><span class="line">    return title+&apos;=&apos;+content;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>上面的代码表示，获取到这个块接收的古诗的标题和内容，用等号进行拼接，返回拼接后的字符串。将所有块的生成器函数写在一个 JS 文件中，放在 assets 目录下。</p>
<h4 id="4-建立数据实体类和数据库"><a href="#4-建立数据实体类和数据库" class="headerlink" title="4. 建立数据实体类和数据库"></a>4. 建立数据实体类和数据库</h4><p>在这个场景中，我们会有很多的古诗，所以需要一个数据库。我们在这个项目中使用 Litepal 这个第三方库来帮助创建数据库。关于 Litepal 的使用在这里不赘述，重点在于数据实体类的创建。下面是诗歌实体类中的成员变量：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">private int id;</span><br><span class="line">private String title;//标题</span><br><span class="line">private String writor;//作者</span><br><span class="line">private List&lt;String&gt; contents;//内容</span><br><span class="line">private String dynasty;//作者朝代</span><br><span class="line">private int level; //根据诗歌的难易程度所划分的等级，分为1-6,1最简单，6最难。</span><br></pre></td></tr></table></figure>

<p>我们将收集的古诗素材按照一定的规则整理成一个文件，然后在应用启动时将这个文件中的所有古诗都加载到数据库中，便于之后的出题和判断匹配正误。</p>
<p>这里我们写了一个数据工具类 DataUtil，定义了一个抽象方法，遍历这个古诗素材文件，按照规则提取出每首诗的标题、作者等信息，保存进数据库中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">public static void initPoetryDataBase(Context context) &#123;</span><br><span class="line">    //先清空该数据库中所有的古诗</span><br><span class="line">    DataSupport.deleteAll(Poetry.class);</span><br><span class="line">    try&#123;</span><br><span class="line">        InputStream is = context.getAssets().open(&quot;poetry/poetry.txt&quot;);</span><br><span class="line">        BufferedReader br=new BufferedReader(new InputStreamReader(is));</span><br><span class="line">        String line=&quot;&quot;;</span><br><span class="line">        while ((line=br.readLine())!=null) &#123;</span><br><span class="line">            String[] arrs=null;//备用数组</span><br><span class="line">            Poetry p=new Poetry();</span><br><span class="line">            arrs=line.split(&quot;&gt;&quot;);</span><br><span class="line">            p.setLevel(Integer.parseInt(arrs[0]));</span><br><span class="line">            p.setTitle(arrs[1]);</span><br><span class="line">            p.setWritor(arrs[2]);</span><br><span class="line">            p.setDynasty(arrs[3]);</span><br><span class="line">            List&lt;String&gt; contents = new ArrayList&lt;&gt;();</span><br><span class="line">            for(int i = 4; i&lt;arrs.length;i++)&#123;</span><br><span class="line">                contents.add(arrs[i]);</span><br><span class="line">            &#125;</span><br><span class="line">            p.setContents(contents);</span><br><span class="line">            p.save();</span><br><span class="line">        &#125;</span><br><span class="line">        br.close();</span><br><span class="line">        is.close();</span><br><span class="line">    &#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; catch(IOException e)&#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5-初始化Activity"><a href="#5-初始化Activity" class="headerlink" title="5.  初始化Activity"></a>5.  初始化Activity</h4><p>新建一个 Activity 继承自 AbstractBlocklyActivity 或者 BlocklySectionsActivity（继承这个用于实现关卡）。这里就继承 AbstractBlocklyActivity。覆盖父类的抽象方法。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">//添加js生成器函数路径</span><br><span class="line">private static final List&lt;String&gt; JAVASCRIPT_GENERATORS = Arrays.asList(</span><br><span class="line">           &quot;generator.js&quot;              </span><br><span class="line">   );</span><br><span class="line">   //点击run后的回调</span><br><span class="line">   CodeGenerationRequest.CodeGeneratorCallback mCodeGeneratorCallback = </span><br><span class="line">           new CodeGenerationRequest.CodeGeneratorCallback() &#123;</span><br><span class="line">       @Override</span><br><span class="line">       public void onFinishCodeGeneration(String generatedCode) &#123;</span><br><span class="line">          //这里面写匹配是否正确的判断逻辑 </span><br><span class="line">       &#125;</span><br><span class="line">   &#125;;</span><br><span class="line">/**</span><br><span class="line">    * 工具栏</span><br><span class="line">    * @return toolbox的路径</span><br><span class="line">    */</span><br><span class="line">   @Override</span><br><span class="line">   protected String getToolboxContentsXmlPath() &#123;</span><br><span class="line">       return &quot;poetry/toolbox.xml&quot;;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   /**</span><br><span class="line">    * 此函数用于添加定义block块的路径，路径为json文件</span><br><span class="line">    * @return block块的集合</span><br><span class="line">    */</span><br><span class="line">   @Override</span><br><span class="line">   protected List&lt;String&gt; getBlockDefinitionsJsonPaths() &#123;</span><br><span class="line">       List&lt;String&gt; assetPaths = new ArrayList&lt;&gt;();</span><br><span class="line">       assetPaths.add(&quot;poetry/poetry.json&quot;);</span><br><span class="line">       return assetPaths;</span><br><span class="line">   &#125;</span><br><span class="line">//添加js生成器函数路径</span><br><span class="line">   @Override</span><br><span class="line">   protected List&lt;String&gt; getGeneratorsJsPaths() &#123;</span><br><span class="line">       return JAVASCRIPT_GENERATORS;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   @Override</span><br><span class="line">   protected CodeGenerationRequest.CodeGeneratorCallback getCodeGenerationCallback() &#123;</span><br><span class="line">       return mCodeGeneratorCallback;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>在这步中，我们将一个 Activity 初始化成了一个具有 Blockly 工具栏、工作区等组件的 BlocklyActivity。接下来就是实现场景的具体功能。</p>
<h4 id="6-从数据库中提取数据封装成工作区中的块"><a href="#6-从数据库中提取数据封装成工作区中的块" class="headerlink" title="6. 从数据库中提取数据封装成工作区中的块"></a>6. 从数据库中提取数据封装成工作区中的块</h4><p>在第二步中提到我们这个场景中没有用到 Toolbox，因为我们所有的块都是在 Activity 初始化的时候直接加载到工作区中的。</p>
<p>实现随机出题的思路是：根据指定的古诗难度，从数据库中随机选取两首对应难度的古诗，使用一个工具类将这两首古诗的标题、所有诗句都封装成我们定义好的 Blockly 块，写入一个临时文件中。在 Activity 初始化时，从这个临时文件中加载所有的块，填充到工作区中，具体的代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">     * 针对整诗匹配场景来生成XML文件</span><br><span class="line">     * 根据传入的level的值从数据库中随机选择响应level的诗歌来生成XML文件，写入fos流所在的文件中</span><br><span class="line">     * @param fos</span><br><span class="line">     * @param level</span><br><span class="line">     */</span><br><span class="line">    public static void generateWholePoetryXML(FileOutputStream fos, int level)&#123;</span><br><span class="line">        List&lt;Poetry&gt; poetryList = DataSupport.where(&quot;level = ?&quot;,level+&quot;&quot;).find(Poetry.class);</span><br><span class="line">        Random random = new Random(System.currentTimeMillis());</span><br><span class="line">        try &#123;</span><br><span class="line">            //获取XmlSerializer对象</span><br><span class="line">            XmlPullParserFactory factory = XmlPullParserFactory.newInstance();</span><br><span class="line">            XmlSerializer xmlSerializer = factory.newSerializer();</span><br><span class="line">            //设置输出流对象</span><br><span class="line">            xmlSerializer.setOutput(fos, &quot;utf-8&quot;);</span><br><span class="line">            //文档开始</span><br><span class="line">            xmlSerializer.startDocument(&quot;utf-8&quot;, true);</span><br><span class="line">            //开始一个标签</span><br><span class="line">            xmlSerializer.startTag(null,&quot;toolbox&quot;);</span><br><span class="line">            for(int i = 0; i&lt; 2;i++)&#123;</span><br><span class="line">                int index = random.nextInt(poetryList.size());</span><br><span class="line">                Poetry p = poetryList.get(index);</span><br><span class="line">                xmlSerializer.startTag(null,&quot;block&quot;);</span><br><span class="line">                xmlSerializer.attribute(null, &quot;type&quot;,&quot;poetry&quot;);</span><br><span class="line">                xmlSerializer.startTag(null,&quot;value&quot;);</span><br><span class="line">                xmlSerializer.attribute(null, &quot;name&quot;,&quot;TITLE&quot;);</span><br><span class="line">                xmlSerializer.startTag(null,&quot;block&quot;);</span><br><span class="line">                xmlSerializer.attribute(null, &quot;type&quot;,&quot;poetry_title&quot;);</span><br><span class="line">                xmlSerializer.startTag(null,&quot;field&quot;);</span><br><span class="line">                xmlSerializer.attribute(null,&quot;name&quot;,&quot;TITLE&quot;);</span><br><span class="line">                xmlSerializer.text(p.getTitle());</span><br><span class="line">                xmlSerializer.endTag(null,&quot;field&quot;);</span><br><span class="line">                xmlSerializer.endTag(null,&quot;block&quot;);</span><br><span class="line">                xmlSerializer.endTag(null,&quot;value&quot;);</span><br><span class="line">                xmlSerializer.endTag(null,&quot;block&quot;);</span><br><span class="line">                for(String c : p.getContents())&#123;</span><br><span class="line">                    xmlSerializer.startTag(null,&quot;block&quot;);</span><br><span class="line">                    xmlSerializer.attribute(null,&quot;type&quot;,&quot;poetry_contents&quot;);</span><br><span class="line">                    xmlSerializer.startTag(null,&quot;field&quot;);</span><br><span class="line">                    xmlSerializer.attribute(null,&quot;name&quot;,&quot;CONTENT&quot;);</span><br><span class="line">                    xmlSerializer.text(c);</span><br><span class="line">                    xmlSerializer.endTag(null,&quot;field&quot;);</span><br><span class="line">                    xmlSerializer.endTag(null,&quot;block&quot;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            //每一个endTag对应的startTag</span><br><span class="line">            xmlSerializer.endTag(null,&quot;toolbox&quot;);</span><br><span class="line">            xmlSerializer.endDocument();</span><br><span class="line"></span><br><span class="line">        &#125; catch (XmlPullParserException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>这是 Util 工具类中的一个静态方法，本质上是依照一个 Toolbox 的书写形式来用动态生成一个 XML 文件，以达到写入动态数据的目的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">     * 根据不同的level加载不同难度的诗歌。</span><br><span class="line">     * @param level</span><br><span class="line">     */</span><br><span class="line">    private void reLoadPoetrys(int level) &#123;</span><br><span class="line">        //重置工作空间</span><br><span class="line">        getController().resetWorkspace();</span><br><span class="line">        //进行动态权限申请</span><br><span class="line">        if (ContextCompat.checkSelfPermission(PoetryBlocklyActivity.this,</span><br><span class="line">                Manifest.permission.WRITE_EXTERNAL_STORAGE)</span><br><span class="line">                != PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">            ActivityCompat.requestPermissions(PoetryBlocklyActivity.this,</span><br><span class="line">                    new String[] &#123;Manifest.permission.WRITE_EXTERNAL_STORAGE&#125;,1);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            load(level);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    /**</span><br><span class="line">     * 初始化工作区时将块散乱排列</span><br><span class="line">     */</span><br><span class="line">    public void load(int level)&#123;</span><br><span class="line">        File directory = Environment.getExternalStorageDirectory();</span><br><span class="line">        File file = new File(directory,&quot;poetry_workspace.xml&quot;);</span><br><span class="line">        if(file.exists())&#123;</span><br><span class="line">            file.delete();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        try &#123;</span><br><span class="line">            file.createNewFile();</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        try &#123;</span><br><span class="line">            FileOutputStream fos = new FileOutputStream(file);</span><br><span class="line">            Util.generateWholePoetryXML(fos,level);</span><br><span class="line">            fos.close();</span><br><span class="line">            FileInputStream fis = new FileInputStream(file);</span><br><span class="line">            //加载指定XML文件中的块</span><br><span class="line">            List&lt;Block&gt; blocks = BlocklyXmlHelper.loadFromXml(fis,</span><br><span class="line">                    getController().getBlockFactory());</span><br><span class="line"></span><br><span class="line">            //将块打乱排列</span><br><span class="line">            for (int i = 0; i &lt; blocks.size(); i++) &#123;</span><br><span class="line">                Block copiedModel = blocks.get(i).deepCopy();</span><br><span class="line">                copiedModel.setPosition((int) (Math.random() * CARPET_SIZE) - CARPET_SIZE / 2,</span><br><span class="line">                        (int) (Math.random() * CARPET_SIZE) - CARPET_SIZE / 2);</span><br><span class="line">                getController().addRootBlock(copiedModel);</span><br><span class="line">            &#125;</span><br><span class="line">            fis.close();</span><br><span class="line">        &#125; catch (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; catch (BlockLoadingException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 动态权限申请结果回调</span><br><span class="line">     * @param requestCode</span><br><span class="line">     * @param permissions</span><br><span class="line">     * @param grantResults</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) &#123;</span><br><span class="line">        switch (requestCode)&#123;</span><br><span class="line">            case 1:</span><br><span class="line">                if(grantResults.length &gt; 0 &amp;&amp;</span><br><span class="line">                        grantResults[0] == PackageManager.PERMISSION_GRANTED)&#123;</span><br><span class="line">                    Toast.makeText(this, &quot;允许了权限&quot;, Toast.LENGTH_SHORT).show();</span><br><span class="line">                    load(currentLevel);</span><br><span class="line">                &#125;else&#123;</span><br><span class="line">                    Toast.makeText(PoetryBlocklyActivity.this, &quot;你拒绝了权限申请&quot;, Toast.LENGTH_SHORT).show();</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>上面代码中一共是三个方法，reLoadPoetrys() 方法主要是进行一个动态权限的申请，因为我们会在手机的储存卡中生成一个临时的文件，所以需要进行权限申请。</p>
<p>load() 方法是真正实现在工作区中加载指定的块并且支持随机散乱排列的一个方法。首先在手机储存卡中创建一个临时的文件，然后使用之前的工具类往这个文件中写入动态的内容，之后使用 <strong>List&lt; Block &gt; blocks = BlocklyXmlHelper.loadFromXml(fis, getController().getBlockFactory());</strong> 这行代码将这个文件中的对块的引用转化成一个一个 Block 实体类。这个方法是在 Blockly 的核心库中实现好的，我们可以直接拿来用。之后对返回的列表中的每个块进行一个深拷贝，然后为拷贝对象指定一个随机的工作区位置。这样就实现了块在工作区中散乱排列。最后使用 <strong>getController().addRootBlock(copiedModel);</strong> 这行代码将所有的块加入到工作区中，实现最终的出题效果。</p>
<p>onRequestPermissionsResult（）是权限申请的回调方法，这里不多说。</p>
<p>最后，我们只需要在 Activity 初始化的时候或者变换当前关卡时，调用 reLoadPoetrys() 这个方法即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">    super.onCreate(savedInstanceState);</span><br><span class="line">    reLoadPoetrys(currentLevel);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="7-实现多重关卡"><a href="#7-实现多重关卡" class="headerlink" title="7. 实现多重关卡"></a>7. 实现多重关卡</h4><p>其实通过上面这些方法的铺垫，实现多重关卡非常简单，只需要修改 reLoadPoetrys() 这个方法的传入参数即可。（这个方法的参数是当前的关卡数，也是要所选古诗的难度，两者是一一对应的）</p>
<p>修改我们的 Activity，让它继承自 BlocklySectionsActivity，这时需要多覆盖两个父类的抽象方法，之前覆盖的抽象方法都不用做修改，因为 BlocklySectionsActivity 也是 AbstractBlocklyActivity 的一个子类。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 创建等级不同的section，实现诗歌难易递进闯关</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">@NonNull</span><br><span class="line">@Override</span><br><span class="line">protected ListAdapter onCreateSectionsListAdapter() &#123;</span><br><span class="line">    String[] levelNames = new String[6];</span><br><span class="line">    for (int i = 0; i &lt; 6; ++i) &#123;</span><br><span class="line">        levelNames[i] = &quot;关卡 &quot; + (i + 1);</span><br><span class="line">    &#125;</span><br><span class="line">    return new ArrayAdapter&lt;&gt;(this,</span><br><span class="line">            android.R.layout.simple_list_item_activated_1,</span><br><span class="line">            android.R.id.text1,</span><br><span class="line">            levelNames);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * section改变时的回调</span><br><span class="line"> * @param oldSection</span><br><span class="line"> * @param newSection</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">@Override</span><br><span class="line">protected boolean onSectionChanged(int oldSection, int newSection) &#123;</span><br><span class="line">    currentLevel = newSection+1;</span><br><span class="line">    Log.i(TAG, &quot;onSectionChanged: oldsection=&quot;+oldSection+&quot;,newsection=&quot;+newSection);</span><br><span class="line">    reLoadPoetrys(currentLevel);</span><br><span class="line">    return true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在 onCreateSectionsListAdapter（）这个方法里面创建了六个关卡，然后在点击了不同的 section 时调用 reLoadPoetrys（）方法，传入当前的 level 值即可。</p>
<h4 id="8-编写匹配判断逻辑"><a href="#8-编写匹配判断逻辑" class="headerlink" title="8. 编写匹配判断逻辑"></a>8. 编写匹配判断逻辑</h4><p>经过之前的这些工作，我们已经可以得到一个比较完美的界面，在工作区中可以随机排列两首古诗的标题和句子等待着拼接匹配。但是我们还没有说最为关键的一步，就是编写判断逻辑。即如何判断这些块是拼对了还是拼错了，只有将这个逻辑写出来，这个场景才算真正活过来。在第五步初始化 Activity 时，有一个 CodeGeneratorCallback 我们一直没有理会，我们的判断逻辑其实就是写在这个匿名内部类中。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//点击run后的回调</span><br><span class="line">    CodeGenerationRequest.CodeGeneratorCallback mCodeGeneratorCallback = </span><br><span class="line">            new CodeGenerationRequest.CodeGeneratorCallback() &#123;</span><br><span class="line">        @Override</span><br><span class="line">        public void onFinishCodeGeneration(String generatedCode) &#123;</span><br><span class="line">           //这里面写匹配是否正确的判断逻辑 </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>

<p>上面这个 mCodeGeneratorCallback 是一个匿名内部类的引用，这个匿名内部类实现了 CodeGeneratorCallback 这个接口，onFinishCodeGeneration（）是一个回调，当点击运行按钮时，这个回调方法就会被触发。这个回调方法所携带的参数是各个块的生成器函数的返回值拼接成的一个字符串。我们就是通过分离这个字符串来取得相关信息，以此来进行逻辑的编写。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">public final CodeGenerationRequest.CodeGeneratorCallback mCodeGeneratorCallback =</span><br><span class="line">            new CodeGenerationRequest.CodeGeneratorCallback() &#123;//用户按下运行按钮式打出一个toast,打出的是转换的js代码</span><br><span class="line">                @Override</span><br><span class="line">                public void onFinishCodeGeneration(final String generatedCode) &#123;</span><br><span class="line">                    Log.i(TAG, &quot;generatedCode:\n&quot; + generatedCode);</span><br><span class="line">                    String[] codes = generatedCode.split(&quot;\n&quot;);</span><br><span class="line">                    String finalResult = &quot;&quot;;//存放结果集toast语句</span><br><span class="line">                    for (int i = 0; i &lt; codes.length; i++) &#123;</span><br><span class="line">                        if (codes[i].equals(&quot;&quot;)) &#123;//发现题的题目脱出后，返回的generationCode会多空出一行</span><br><span class="line">                            continue;</span><br><span class="line">                        &#125;</span><br><span class="line">                        if (!codes[i].contains(&quot;=&quot;)) &#123;//没有等号证明不是一首具体的诗</span><br><span class="line">                            finalResult += (codes[i] + &quot; 不能构成一首诗歌\n&quot;);</span><br><span class="line">                            continue;</span><br><span class="line">                        &#125;</span><br><span class="line">                        String[] result = codes[i].split(&quot;=&quot;);</span><br><span class="line">                        if (result.length == 1) &#123;//只有一个空的框架，题目和内容都没有填</span><br><span class="line">                            finalResult += (&quot;这个框架什么都没有\n&quot;);</span><br><span class="line">                            continue;</span><br><span class="line">                        &#125;</span><br><span class="line">                        String title = result[1];</span><br><span class="line">                        List&lt;Poetry&gt; ps = DataSupport.where(&quot;title = ?&quot;, title).find(Poetry.class);</span><br><span class="line">                        if (ps == null || ps.size() == 0) &#123;</span><br><span class="line">                            Log.i(TAG, &quot;执行第几次循环？&quot; + i);</span><br><span class="line">                            finalResult += (title + &quot;没有这首诗\n&quot;);</span><br><span class="line">                            // Toast.makeText(MyBlocklyActivity.this, &quot;没有这首诗&quot;, Toast.LENGTH_SHORT).show();</span><br><span class="line">                            Log.i(TAG, &quot;此时的finalrusult为？&quot; + finalResult);</span><br><span class="line">                        &#125; else &#123;</span><br><span class="line">                            //查找到这首诗歌</span><br><span class="line">                            Poetry p = ps.get(0);</span><br><span class="line">                            StringBuffer sb = new StringBuffer();</span><br><span class="line">                            //查询这首诗歌的所有内容</span><br><span class="line">                            List&lt;String&gt; cts = p.getContents();</span><br><span class="line">                            //将list形式的内容转化成字符串形式。</span><br><span class="line">                            for (String c : cts) &#123;</span><br><span class="line">                                sb.append(c);</span><br><span class="line">                            &#125;</span><br><span class="line">                            String content = sb.toString();</span><br><span class="line">                            if (result.length &lt; 3) &#123;//判断出是否是没有填内容的</span><br><span class="line">                                finalResult += (title + &quot;这首诗并没有完成\n&quot;);</span><br><span class="line">                            &#125; else if (content.equals(result[2])) &#123;</span><br><span class="line">                                finalResult += (title + &quot;匹配正确\n&quot;);</span><br><span class="line">                            &#125; else &#123;</span><br><span class="line">                                finalResult += (title + &quot;匹配错误\n&quot;);</span><br><span class="line">                            &#125;</span><br><span class="line"></span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                    Toast.makeText(PoetryBlocklyActivity.this, finalResult, Toast.LENGTH_SHORT).show();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br></pre></td></tr></table></figure>

<p>每个场景的设计不同，它所需要的判断逻辑也不相同，所以需要根据实际的场景来编写相应的逻辑，并且在编写逻辑的过程中要尽量考虑到各种可能的情形，要具备一定的容错性。</p>
<h4 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h4><p>上述就是利用 Blockly 进行一个实际的场景开发的实例，其实熟知了 Android 平台下 Blockly 的整体执行逻辑后，你会发现所有场景开发的步骤都是类似的。当然，要想实现一些比较复杂的功能，比如这个例子中的随机出题和块在工作区中散乱排列，还是需要多研究官方给的 demo 和底层的源码。</p>

        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <div id="comment" style='padding:10px;' class="vcomment"></div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>
<script>
    var GUEST_INFO = ['nick','mail','link'];
    var guest_info = ''.split(',').filter(function(item){
        return GUEST_INFO.indexOf(item) > -1
    });
    var notify = 'false' == true;
    var verify = 'false' == true;
    new Valine({
        el: '.vcomment',
        notify: notify,
        verify: verify,
        appId: "kBAIXiwz3WNBdeedWKIJ57XK-gzGzoHsz",
        appKey: "hGgJDQbyDLHvM3UMFXuJyYNU",
        placeholder: "来啊，快活啊~~",
        pageSize:'',
        avatar:'',
        lang:''
    });
</script>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2018/04/03/use-Blockly-create-a-maze-game/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/11/21/11-tasks-from-now-to-graduation/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/daily_pic.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/icon.jpg" alt="Owen Lee's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        2924354040@qq.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="mailto:2924354040@qq.com" target="_blank" title="给我发邮件">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        给我发邮件
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2019/07/">七月 2019<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/05/">五月 2019<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/12/">十二月 2018<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/11/">十一月 2018<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/09/">九月 2018<span class="sidebar_archives-count">19</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/08/">八月 2018<span class="sidebar_archives-count">13</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/07/">七月 2018<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/06/">六月 2018<span class="sidebar_archives-count">13</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/05/">五月 2018<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/04/">四月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/03/">三月 2018<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/11/">十一月 2017<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/10/">十月 2017<span class="sidebar_archives-count">18</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/09/">九月 2017<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/05/">五月 2017<span class="sidebar_archives-count">8</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                分类
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/想法/">想法<span class="sidebar_archives-count">24</span></a></li><li><a class="sidebar_archives-link" href="/categories/技术/">技术<span class="sidebar_archives-count">27</span></a></li><li><a class="sidebar_archives-link" href="/categories/笔试面试/">笔试面试<span class="sidebar_archives-count">29</span></a></li><li><a class="sidebar_archives-link" href="/categories/译文/">译文<span class="sidebar_archives-count">8</span></a>
            </ul>
        </li>
        
            <li class="divider"></li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/2017/10/20/about-me/" title="关于我">
                
                关于我
            </a>
        </li>
        
    
        <li>
            <a href="/tags/" title="标签云">
                
                标签云
            </a>
        </li>
        
    
        <li>
            <a href="/timeline/" title="时间轴">
                
                时间轴
            </a>
        </li>
        
    
        <li>
            <a href="/gallery/" title="图库">
                
                图库
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
        <li>
            <a href="/archives">
                文章总数
                <span class="sidebar-badge">103</span>
            </a>
        </li>
        
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->


<!-- Theme Material -->


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://github.com/owenleexiaoyu" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    
        <a href="https://www.zhihu.com/people/xiao-yu-7-94/activities" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-zhihu">
                <span class="visuallyhidden">Zhihu</span>
            </button><!--
     --></a>
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    
    
    <!-- V2EX -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;2016&nbsp;-<script type="text/javascript">var fd = new Date();document.write("&nbsp;" + fd.getFullYear() + "&nbsp;");</script>海树
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?V/53wGualMuiPM3xoetD5Q==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>





    <!-- Leancloud -->
    <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
    <script>
        AV.initialize('kBAIXiwz3WNBdeedWKIJ57XK-gzGzoHsz', 'hGgJDQbyDLHvM3UMFXuJyYNU');
    </script>
    <script type="text/ls-javascript" id="leancloud-views-script">
    function showTime(Counter) {
        var query = new AV.Query(Counter);
        $('.leancloud-views_num').each(function() {
            var url = $(this).attr('id').trim();
            query.equalTo('url', url);
            query.find({
                success: function(results) {
                    if (results.length === 0) {
                        var content = '0 ' + $(document.getElementById(url)).text();
                        $(document.getElementById(url)).text(content);
                        return;
                    }
                    for (var i = 0; i < results.length; i++) {
                        var object = results[i];
                        var content = object.get('time') + ' ' + $(document.getElementById(url)).text();
                        $(document.getElementById(url)).text(content);
                    }
                },
                error: function(object, error) {
                    console.log('Error: ' + error.code + ' ' + error.message);
                }
            });
        });
    }

    function addCount(Counter) {
      var Counter = AV.Object.extend('Counter');
      url = $('.leancloud-views_num').attr('id').trim();
      title = $('.leancloud-views_num').attr('data-flag-title').trim();
      var query = new AV.Query(Counter);
      query.equalTo('url', url);
      query.find({
          success: function(results) {
            if (results.length > 0) {
                var counter = results[0];
                counter.fetchWhenSave(true);
                counter.increment('time');
                counter.save(null, {
                    success: function(counter) {
                        var content =  counter.get('time') + ' ' + $(document.getElementById(url)).text();
                        $(document.getElementById(url)).text(content);
                    },
                    error: function(counter, error) {
                        console.log('Failed to save Visitor num, with error message: ' + error.message);
                    }
                });
            } else {
              var newcounter = new Counter();
              newcounter.set('title', title);
              newcounter.set('url', url);
              newcounter.set('time', 1);
              newcounter.save(null, {
                  success: function(newcounter) {
                      console.log('newcounter.get(\'time\')='+newcounter.get('time'));
                      var content = newcounter.get('time') + ' ' + $(document.getElementById(url)).text();
                      $(document.getElementById(url)).text(content);
                  },
                  error: function(newcounter, error) {
                      console.log('Failed to create');
                  }
              });
            }
        },
        error: function(error) {
            console.log('Error:' + error.code + ' ' + error.message);
        }
      });
    }
    $(function() {
        var Counter = AV.Object.extend('Counter');
        if ($('.leancloud-views_num').length === 1) {
            addCount(Counter);
        } else if ($('.post-title-link').length > 1) {
            showTime(Counter);
        }
    });
</script>






   





<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->


    
        <script>lsloader.load("hanabi","/js/hanabi-browser-bundle.js?Pki5+pzkluqu53g+ouMWpA==", true)</script>
    


<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
    
        
        
        HanabiBrowser.start('pre code',true);
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.2 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
